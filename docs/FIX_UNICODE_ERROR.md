# –†–ï–®–ï–ù–ê: –ü—Ä–æ–±–ª–µ–º–∞ UnicodeEncodeError (–ø—Ä–∏—á–∏–Ω–∞ HTTP 503)

## –ù–∞–π–¥–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞
–û—à–∏–±–∫–∞ HTTP 503 –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –∏–∑-–∑–∞ **UnicodeEncodeError** –ø—Ä–∏ –≤—ã–≤–æ–¥–µ —ç–º–æ–¥–∑–∏ –≤ –∫–æ–Ω—Å–æ–ª—å:
```
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f9ea' in position 0
```

## –ü—Ä–∏—á–∏–Ω–∞
–ù–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö (–≤ —Ç–æ–º —á–∏—Å–ª–µ Amvera) –∫–æ–Ω—Å–æ–ª—å –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å UTF-8 —ç–º–æ–¥–∑–∏. –ö–æ–≥–¥–∞ Python –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–≤–µ—Å—Ç–∏ —ç–º–æ–¥–∑–∏ (üöÄ, üì¶, ‚úÖ –∏ —Ç.–¥.), –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏, –∏ —Å–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç.

## –†–µ—à–µ–Ω–∏–µ

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ stdout/stderr
–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –Ω–∞—á–∞–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏ `main()`:
```python
if hasattr(sys.stdout, 'reconfigure'):
    sys.stdout.reconfigure(encoding='utf-8', errors='replace')
    sys.stderr.reconfigure(encoding='utf-8', errors='replace')
```

### 2. –ó–∞–º–µ–Ω–∞ —ç–º–æ–¥–∑–∏ –Ω–∞ ASCII-—Ç–µ–≥–∏
–ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ —ç–º–æ–¥–∑–∏ –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –º–∞—Ä–∫–µ—Ä—ã:
- üöÄ ‚Üí `[START]`
- üì¶ ‚Üí `[IMPORT]`
- ‚úÖ ‚Üí `[OK]`
- ‚ùå ‚Üí `[ERROR]`
- üîß ‚Üí `[ENV]`
- –∏ —Ç.–¥.

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### minimal_server.py
- –£–±—Ä–∞–Ω—ã –≤—Å–µ —ç–º–æ–¥–∑–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏
- –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ ASCII-—Ñ–æ—Ä–º–∞—Ç–µ

### webapp_only.py
- –£–±—Ä–∞–Ω—ã –≤—Å–µ —ç–º–æ–¥–∑–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏
- –°–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–µ–µ)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ
```bash
# –¢–µ—Å—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
python tests/test_minimal_server.py

# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
python tests/test_server_diagnostics.py
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Amvera

### –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (amvera.yml)
```yaml
run:
  scriptName: minimal_server.py  # –î–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
```

### –®–∞–≥ 1: –¢–µ—Å—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
1. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
   ```bash
   git add .
   git commit -m "[v1.0.3] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UnicodeEncodeError - —É–±—Ä–∞–Ω—ã —ç–º–æ–¥–∑–∏"
   git push
   ```

2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ Amvera

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ endpoints:
   - `https://your-app.amvera.io/ping` ‚Üí `{"ping": "pong"}`
   - `https://your-app.amvera.io/` ‚Üí –î–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

### –®–∞–≥ 2: –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –ø–æ–ª–Ω—ã–π webapp (–ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞)
–ï—Å–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏–∑–º–µ–Ω–∏—Ç–µ `amvera.yml`:
```yaml
run:
  scriptName: webapp_only.py  # –ü–æ–ª–Ω—ã–π Web App
```

–ò —Å–Ω–æ–≤–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç.

## –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- [x] UnicodeEncodeError –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- [x] –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- [x] webapp_only.py –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- [x] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Amvera
- [ ] –ü–æ–ª–Ω—ã–π webapp —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Amvera

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **v1.0.1**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP 500 - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫
- **v1.0.2**: –î–æ–±–∞–≤–ª–µ–Ω healthcheck –∏ —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **v1.0.3**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UnicodeEncodeError - —É–±—Ä–∞–Ω—ã —ç–º–æ–¥–∑–∏ ‚úÖ

## –î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
11 –Ω–æ—è–±—Ä—è 2025 –≥.
