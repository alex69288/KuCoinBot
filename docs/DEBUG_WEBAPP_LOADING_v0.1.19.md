# –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (v0.1.19 - –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫ 401, WebApp –∑–∞–≤–∏—Å–∞–µ—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ "–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞..." –∏ –Ω–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é.

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç–æ—á–∫–∏ —Å–±–æ—è:

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `webapp/static/index.html`

#### 1. –§—É–Ω–∫—Ü–∏—è `loadData()`
```javascript
async function loadData() {
  try {
    console.log('üîÑ loadData(): –ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏...');
    console.log('üîÑ loadData(): –í—ã–∑–æ–≤ loadStatus()...');
    await loadStatus();
    console.log('üîÑ loadData(): loadStatus() –∑–∞–≤–µ—Ä—à–µ–Ω');
    console.log('üîÑ loadData(): –í—ã–∑–æ–≤ loadMarket()...');
    await loadMarket();
    console.log('üîÑ loadData(): loadMarket() –∑–∞–≤–µ—Ä—à–µ–Ω');
    console.log('‚úÖ loadData(): –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ');
  } catch (error) {
    console.error('‚ùå loadData(): –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
    console.error('‚ùå loadData(): Stack trace:', error.stack);
    throw error;
  }
}
```

#### 2. –§—É–Ω–∫—Ü–∏—è `loadStatus()`
```javascript
async function loadStatus() {
  try {
    console.log('üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–∞...');
    const initData = getInitData();
    console.log('üìä init_data:', initData);
    const response = await fetch(`/api/status?init_data=${encodeURIComponent(initData)}`);
    console.log('üìä Response –ø–æ–ª—É—á–µ–Ω:', response.status, response.ok);
    if (!response.ok) {
      const errorText = await response.text();
      console.error('üìä –û—à–∏–±–∫–∞ –æ—Ç–≤–µ—Ç–∞:', errorText);
      throw new Error(`HTTP ${response.status}: ${errorText}`);
    }
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
  }
}
```

#### 3. –§—É–Ω–∫—Ü–∏—è `loadMarket()`
```javascript
async function loadMarket() {
  try {
    console.log('üìà –ó–∞–≥—Ä—É–∑–∫–∞ —Ä—ã–Ω–∫–∞...');
    const initData = getInitData();
    console.log('üìà init_data:', initData);
    const response = await fetch(`/api/market?init_data=${encodeURIComponent(initData)}`);
    console.log('üìà Response –ø–æ–ª—É—á–µ–Ω:', response.status, response.ok);
    if (!response.ok) {
      const errorText = await response.text();
      console.error('üìà –û—à–∏–±–∫–∞ –æ—Ç–≤–µ—Ç–∞:', errorText);
      throw new Error(`HTTP ${response.status}: ${errorText}`);
    }
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
  }
}
```

## –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

1. **–ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏** - –∫–æ–≥–¥–∞ `loadData()` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
2. **init_data** - –∫–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ API (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "debug_mode")
3. **HTTP —Å—Ç–∞—Ç—É—Å** - –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 200)
4. **–û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞** - –µ—Å–ª–∏ JSON –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π
5. **Stack trace** - –ø–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –æ—à–∏–±–æ–∫

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: `python main_dev.py`
2. –û—Ç–∫—Ä–æ–π—Ç–µ http://127.0.0.1:8000 –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12)
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

## –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ (—É—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)

```
üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...
‚úÖ –ò–∫–æ–Ω–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
üîÑ loadData(): –ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏...
üîÑ loadData(): –í—ã–∑–æ–≤ loadStatus()...
üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–∞...
üìä init_data: debug_mode
üìä Response –ø–æ–ª—É—á–µ–Ω: 200 true
‚úÖ –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∂–µ–Ω: {positions: {...}, ...}
üîÑ loadData(): loadStatus() –∑–∞–≤–µ—Ä—à–µ–Ω
üîÑ loadData(): –í—ã–∑–æ–≤ loadMarket()...
üìà –ó–∞–≥—Ä—É–∑–∫–∞ —Ä—ã–Ω–∫–∞...
üìà init_data: debug_mode
üìà Response –ø–æ–ª—É—á–µ–Ω: 200 true
‚úÖ –†—ã–Ω–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω: {symbol: "BTC/USDT", ...}
üîÑ loadData(): loadMarket() –∑–∞–≤–µ—Ä—à–µ–Ω
‚úÖ loadData(): –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–∞ XXX–º—Å
‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
‚úÖ Fallback –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—â–µ–Ω—ã
‚úÖ –°—Ç–∞—Ç—É—Å —Ç–æ—Ä–≥–æ–≤–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ó–∞–≤–∏—Å–∞–Ω–∏–µ –Ω–∞ loadStatus()
–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ:
```
üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–∞...
üìä init_data: debug_mode
üìä Response –ø–æ–ª—É—á–µ–Ω: 200 true
```
–ù–æ –¥–∞–ª—å—à–µ –Ω–∏—á–µ–≥–æ - –ø—Ä–æ–±–ª–µ–º–∞ –≤ `response.json()` –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ DOM.

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ HTTP
–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ:
```
üìä –û—à–∏–±–∫–∞ –æ—Ç–≤–µ—Ç–∞: {"detail": "..."}
‚ùå loadData(): –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: Error: HTTP 500: ...
```
–ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞.

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ DOM
–ï—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö –µ—Å—Ç—å –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞:
```
Cannot read property 'textContent' of null
```
–ó–Ω–∞—á–∏—Ç HTML —ç–ª–µ–º–µ–Ω—Ç—ã —Å –Ω—É–∂–Ω—ã–º–∏ ID –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç.

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç

–°–æ–∑–¥–∞–Ω `tests/test_api_endpoints.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ API –±–µ–∑ –±—Ä–∞—É–∑–µ—Ä–∞:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
python main_dev.py

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
python tests/test_api_endpoints.py
```

## –ö–æ–º–º–∏—Ç

**5c01f50** - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö WebApp

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–≥–æ–≤ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞, –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ –ø—Ä–æ–±–ª–µ–º—ã –∏ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å.
