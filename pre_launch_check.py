"""
–§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –ü–ï–†–ï–î –ó–ê–ü–£–°–ö–û–ú –ë–û–¢–ê
"""
import json
from utils.position_manager import get_positions_count

print("=" * 70)
print("–ì–û–¢–û–í–ù–û–°–¢–¨ –ö –ó–ê–ü–£–°–ö–£ –ë–û–¢–ê")
print("=" * 70)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ü–æ–∑–∏—Ü–∏–∏
with open('position_state.json', 'r') as f:
    state = json.load(f)

btc = state.get('BTC/USDT', {})
positions = btc.get('positions', [])

print(f"\n‚úÖ 1. –ü–û–ó–ò–¶–ò–ò:")
print(f"   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {len(positions)}")
for pos in positions:
    print(f"   - –ü–æ–∑–∏—Ü–∏—è #{pos['id']}: {pos['entry_price']:,.2f} USDT @ {pos['position_size_usdt']:.2f} USDT")

print(f"\n   üí∞ –û–±—â–∞—è —Å—Ç–∞–≤–∫–∞: {btc.get('total_position_size_usdt', 0):.2f} USDT")
print(f"   üìà Max —Ü–µ–Ω–∞ (TP): {btc.get('max_entry_price', 0):,.2f} USDT")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
count = get_positions_count('BTC/USDT')
print(f"\n‚úÖ 2. –ë–õ–û–ö–ò–†–û–í–ö–ê –ù–û–í–´–• –ü–û–ö–£–ü–û–ö:")
if count > 0:
    print(f"   üîí –ê–ö–¢–ò–í–ù–ê - {count} –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π")
    print(f"   –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–∫—É–ø–∫–∏ –±–æ—Ç –≤—ã–¥–∞—Å—Ç:")
    print(f"   ‚õî –ü–û–ö–£–ü–ö–ê –û–¢–ú–ï–ù–ï–ù–ê: –£–∂–µ –µ—Å—Ç—å {count} –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π")
else:
    print(f"   ‚ö†Ô∏è  –ù–ï–ê–ö–¢–ò–í–ù–ê - –ø–æ–∑–∏—Ü–∏–π –Ω–µ—Ç")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞
print(f"\n‚úÖ 3. –°–¢–†–£–ö–¢–£–†–ê position_state.json:")
has_old_fields = any(field in btc for field in ['position', 'entry_price', 'position_size_usdt', 'opened_at'])
if has_old_fields:
    print(f"   ‚ö†Ô∏è  –ï–°–¢–¨ –°–¢–ê–†–´–ï –ü–û–õ–Ø - –Ω—É–∂–Ω–∞ –æ—á–∏—Å—Ç–∫–∞!")
else:
    print(f"   ‚úÖ –ß–ò–°–¢–ê–Ø - —Ç–æ–ª—å–∫–æ –Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–º–∞—Å—Å–∏–≤ positions)")

print("\n" + "=" * 70)
print("–ì–û–¢–û–í –ö –ó–ê–ü–£–°–ö–£")
print("=" * 70)
print("\nüöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π: python main.py")
print("\nüìã –ß–¢–û –ë–£–î–ï–¢ –ü–†–û–ò–°–•–û–î–ò–¢–¨:")
print("   1. –ë–æ—Ç –ù–ï –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏ (—É–∂–µ –µ—Å—Ç—å 2 –æ—Ç–∫—Ä—ã—Ç—ã—Ö)")
print("   2. –ë–æ—Ç –±—É–¥–µ—Ç –∂–¥–∞—Ç—å —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞ –ü–†–û–î–ê–ñ–£")
print("   3. –ü—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ –∑–∞–∫—Ä–æ—é—Ç—Å—è –í–°–ï –ø–æ–∑–∏—Ü–∏–∏ (2.10 USDT)")
print("   4. Take Profit –±—É–¥–µ—Ç –æ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã (110,185.70 USDT)")
print("   5. –ü–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ —Å–º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é")
print("\n" + "=" * 70)
